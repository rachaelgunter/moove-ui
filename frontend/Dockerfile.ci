FROM node:14.15-alpine As builder

WORKDIR /usr/src/app

COPY . .

ARG REACT_APP_GRAPHQL_API
ARG REACT_APP_AUTH0_DOMAIN
ARG REACT_APP_AUTH0_CLIENT_ID
ARG REACT_APP_AUTH0_AUDIENCE
ARG REACT_APP_AUTH0_REDIRECT_URI
ARG REACT_APP_JUPYTERHUB_URL
ARG REACT_APP_ROAD_IQ_URL
ARG REACT_APP_AUTH0_CLAIMS_NAMESPACE
<<<<<<< HEAD
ARG REACT_APP_DATASET_ASSETS_BUCKET
=======
ARG REACT_APP_MAPBOX_TOKEN
ARG DISABLE_ESLINT_PLUGIN
ARG GENERATE_SOURCEMAP
>>>>>>> develop

RUN npm ci && npm run build

FROM nginx:1.18.0-alpine

COPY nginx.conf /etc/nginx/conf.d/default.conf
COPY --from=builder /usr/src/app/build/ /usr/share/nginx/html
